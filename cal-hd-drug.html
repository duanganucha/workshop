<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medical Dosing Guidelines - Enhanced Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        max-width: 1400px;
        margin: 0 auto;
      }

      h1 {
        color: #2c3e50;
        text-align: center;
        margin-bottom: 30px;
        font-size: 2.2em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .export-btn {
        background: linear-gradient(45deg, #28a745, #20c997);
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 16px;
        border-radius: 25px;
        cursor: pointer;
        display: block;
        margin: 20px auto 30px auto;
        box-shadow: 0 8px 15px rgba(40, 167, 69, 0.3);
        transition: all 0.3s ease;
        font-weight: bold;
      }

      .export-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 25px rgba(40, 167, 69, 0.4);
      }

      .export-btn:active {
        transform: translateY(0);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      th {
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
        padding: 15px 10px;
        text-align: center;
        font-weight: bold;
        font-size: 14px;
      }

      td {
        padding: 12px 10px;
        border-bottom: 1px solid #ecf0f1;
        text-align: left;
        font-size: 13px;
        line-height: 1.4;
      }

      tr:nth-child(even) {
        background-color: #f8f9fa;
      }

      tr:hover {
        background-color: #e3f2fd;
        transition: background-color 0.3s ease;
      }

      .drug-name {
        font-weight: bold;
        color: #2c3e50;
      }

      .note {
        background: linear-gradient(45deg, #fff3cd, #ffeaa7);
        border: 1px solid #ffc107;
        border-radius: 8px;
        padding: 15px;
        margin: 20px 0;
        font-style: italic;
        color: #856404;
      }

      .footer {
        margin-top: 30px;
        text-align: center;
        color: #6c757d;
        font-size: 12px;
        border-top: 1px solid #dee2e6;
        padding-top: 20px;
      }

      .calculator-form {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        border: 2px solid #007bff;
        border-radius: 15px;
        padding: 25px;
        margin: 30px 0;
        box-shadow: 0 8px 20px rgba(0, 123, 255, 0.2);
      }

      .calculator-form h2 {
        color: #007bff;
        margin-bottom: 20px;
        text-align: center;
        font-size: 1.5em;
      }

      .form-row {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .form-group {
        flex: 1;
        min-width: 200px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
        color: #495057;
        font-size: 14px;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 12px;
        border: 2px solid #ced4da;
        border-radius: 8px;
        font-size: 14px;
        transition: border-color 0.3s ease;
        box-sizing: border-box;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
      }

      .calc-btn {
        background: linear-gradient(45deg, #007bff, #0056b3);
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 16px;
        border-radius: 25px;
        cursor: pointer;
        display: block;
        margin: 25px auto;
        font-weight: bold;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
      }

      .calc-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 123, 255, 0.4);
      }

      .result-display {
        background: linear-gradient(45deg, #d4edda, #c3e6cb);
        border: 2px solid #28a745;
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
        text-align: center;
        color: #155724;
        display: none;
        box-shadow: 0 4px 10px rgba(40, 167, 69, 0.2);
      }

      .result-display h3 {
        margin-top: 0;
        color: #155724;
        font-size: 1.3em;
      }

      .result-info {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin: 15px 0;
        text-align: left;
      }

      .result-info p {
        margin: 5px 0;
        padding: 8px;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 5px;
      }

      .dosing-result {
        background: linear-gradient(45deg, #fff3cd, #ffeaa7);
        border: 2px solid #ffc107;
        border-radius: 8px;
        padding: 12px;
        margin: 5px 0;
        color: #856404;
        font-weight: bold;
        box-shadow: 0 2px 5px rgba(255, 193, 7, 0.2);
      }

      .calculated-dose {
        background: linear-gradient(45deg, #d1ecf1, #bee5eb);
        border: 2px solid #17a2b8;
        border-radius: 8px;
        padding: 12px;
        margin: 5px 0;
        color: #0c5460;
        font-weight: bold;
      }

      .warning-box {
        background: linear-gradient(45deg, #f8d7da, #f5c6cb);
        border: 2px solid #dc3545;
        border-radius: 8px;
        padding: 10px;
        margin: 5px 0;
        color: #721c24;
        font-size: 12px;
      }

      .clear-btn {
        background: linear-gradient(45deg, #6c757d, #5a6268);
        color: white;
        border: none;
        padding: 10px 25px;
        font-size: 14px;
        border-radius: 20px;
        cursor: pointer;
        margin-left: 10px;
        transition: all 0.3s ease;
      }

      .clear-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 10px rgba(108, 117, 125, 0.3);
      }

      .input-group {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .unit-label {
        font-size: 12px;
        color: #6c757d;
        font-weight: normal;
      }

      @media (max-width: 768px) {
        .form-row {
          flex-direction: column;
        }

        .result-info {
          grid-template-columns: 1fr;
        }

        .container {
          padding: 15px;
          margin: 10px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üìä Medical Dosing Guidelines & Calculator</h1>

      <div class="calculator-form">
        <h2>üßÆ Enhanced Patient Dosing Calculator</h2>
        <form id="dosingForm">
          <div class="form-row">
            <div class="form-group">
              <label>Patient Age (‡∏≠‡∏≤‡∏¢‡∏∏‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢):</label>
              <div class="input-group">
                <input
                  type="number"
                  id="age"
                  min="1"
                  max="120"
                  placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏≠‡∏≤‡∏¢‡∏∏"
                  required
                />
                <span class="unit-label">‡∏õ‡∏µ / years</span>
              </div>
            </div>
            <div class="form-group">
              <label>Body Weight (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ï‡∏±‡∏ß):</label>
              <div class="input-group">
                <input
                  type="number"
                  id="weight"
                  min="1"
                  max="300"
                  step="0.1"
                  placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å"
                  required
                />
                <span class="unit-label">kg</span>
              </div>
            </div>
            <div class="form-group">
              <label>Serum Creatinine (‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡∏ï‡∏¥‡∏ô‡∏µ‡∏ô):</label>
              <div class="input-group">
                <input
                  type="number"
                  id="creatinine"
                  min="0.1"
                  max="20"
                  step="0.1"
                  placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡∏ï‡∏¥‡∏ô‡∏µ‡∏ô"
                  required
                />
                <span class="unit-label">mg/dL</span>
              </div>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Gender (‡πÄ‡∏û‡∏®):</label>
              <select id="gender" required>
                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏® / Select gender</option>
                <option value="male">Male (‡∏ä‡∏≤‡∏¢)</option>
                <option value="female">Female (‡∏´‡∏ç‡∏¥‡∏á)</option>
              </select>
            </div>
            <div class="form-group">
              <label>Hemodialysis Status (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï):</label>
              <select id="dialysis">
                <option value="no">No dialysis (‡πÑ‡∏°‡πà‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï)</option>
                <option value="yes">On hemodialysis (‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï)</option>
              </select>
            </div>
            <div class="form-group">
              <label>Indication (‡∏Ç‡πâ‡∏≠‡∏ö‡πà‡∏á‡πÉ‡∏ä‡πâ):</label>
              <input
                type="text"
                id="indication"
                placeholder="‡πÄ‡∏ä‡πà‡∏ô UTI, Pneumonia (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)"
              />
            </div>
          </div>
          <div style="text-align: center">
            <button type="button" class="calc-btn" onclick="calculateDosing()">
              üîç Calculate Dosing (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤)
            </button>
            <button type="button" class="clear-btn" onclick="clearForm()">
              üóëÔ∏è Clear (‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
            </button>
          </div>
        </form>

        <div id="crclResult" class="result-display"></div>
      </div>

      <table id="dosingTable">
        <thead>
          <tr>
            <th style="width: 20%">Drug Name<br />(‡∏ä‡∏∑‡πà‡∏≠‡∏¢‡∏≤‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û)</th>
            <th style="width: 20%">CrCL 10-50 mL/min</th>
            <th style="width: 20%">CrCL < 10 mL/min</th>
            <th style="width: 20%">Hemodialysis<br />(‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï)</th>
            <th style="width: 20%">Calculated Dose<br />(‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="drug-name">Acyclovir inj. 500 mg</td>
            <td>5-12.5 mg/kg q 12-24 hr</td>
            <td>2.5-6.25 mg/kg q 24 hr</td>
            <td>2.5-6.25 mg/kg q24h (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="acyclovir-inj"></td>
          </tr>
          <tr>
            <td class="drug-name">Ampicillin inj. 500 mg</td>
            <td>
              CrCl 30-50: 1-2 gm q 6-8 hr<br />CrCl 10-30: 1-2 gm q 8-12 hr
            </td>
            <td>1-2 gm q 12 hr</td>
            <td>1-2 gm q 12 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="ampicillin-500"></td>
          </tr>
          <tr>
            <td class="drug-name">Ampicillin inj. 1000 mg</td>
            <td>
              CrCl 30-50: 1-2 gm q 6-8 hr<br />CrCl 10-30: 1-2 gm q 8-12 hr
            </td>
            <td>1-2 gm q 12 hr</td>
            <td>1-2 gm q 12 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="ampicillin-1000"></td>
          </tr>
          <tr>
            <td class="drug-name">Amikacin 500 mg</td>
            <td>7.5 mg/kg q 24 hr</td>
            <td>7.5 mg/kg q 48 hr</td>
            <td>7.5 mg/kg q 48 hr (+extra 3.75 mg/kg AD)</td>
            <td class="dosing-column" data-drug="amikacin"></td>
          </tr>
          <tr>
            <td class="drug-name">Augmentin inj. 1.2 gm</td>
            <td>1.2 gm initial dose then 0.6 gm q 12 h</td>
            <td>1.2 gm initial dose then 0.6 gm IV q 24 hr</td>
            <td>
              1.2 gm initial dose then 0.6 gm IV q 24 hr (dialysis day give AD)
            </td>
            <td class="dosing-column" data-drug="augmentin-inj"></td>
          </tr>
          <tr>
            <td class="drug-name">Fortum¬Æ inj. 2g (ceftazidime)</td>
            <td>2 gm IV q 12-24 hr</td>
            <td>2 gm IV q 24-48 hr</td>
            <td>2 gm IV q 24-48 hr (+extra 1 gm AD)</td>
            <td class="dosing-column" data-drug="fortum"></td>
          </tr>
          <tr>
            <td class="drug-name">Cefepime inj. 1 g</td>
            <td>CrCl 30-60: 2 gm q 12 hr<br />CrCl 11-29: 2 gm q 24 hr</td>
            <td>1 gm IV q 24 hr</td>
            <td>1 gm IV q 24 hr (+extra 1 gm AD)</td>
            <td class="dosing-column" data-drug="cefepime"></td>
          </tr>
          <tr>
            <td class="drug-name">Cefazolin inj.1 g</td>
            <td>1-2 g q 12 hr</td>
            <td>1-2 g q 24-48 hr</td>
            <td>1-2 g q 24-48 hr (+extra 0.5-1.0 gm AD)</td>
            <td class="dosing-column" data-drug="cefazolin"></td>
          </tr>
          <tr>
            <td class="drug-name">
              Ceftazidime 2 g + Avibactam 0.5 g (avicefta¬Æ)
            </td>
            <td>CrCl 30-50: 1.25 gm q 8 hr<br />CrCl 10-30: 0.94 gm q 12 hr</td>
            <td>0.94 gm q 48 hr</td>
            <td>0.94 gm q 48 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="ceftazidime-avibactam"></td>
          </tr>
          <tr>
            <td class="drug-name">Cefotaxime inj 1 g</td>
            <td>2 gm IV q 12-24 hr</td>
            <td>2 gm IV q 24 hr</td>
            <td>2 gm IV q 24 hr (+extra 1 gm AD)</td>
            <td class="dosing-column" data-drug="cefotaxime"></td>
          </tr>
          <tr>
            <td class="drug-name">Ciprofloxacin inj. 200 mg</td>
            <td>400 mg q 12 hr</td>
            <td>400 mg q 24 hr</td>
            <td>400 mg q 24 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="ciprofloxacin"></td>
          </tr>
          <tr>
            <td class="drug-name">Fluconazole inj. 100 mg</td>
            <td>50-200 mg q 24 hr</td>
            <td>50-200 mg q 24 hr</td>
            <td>100-400 mg q 24 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="fluconazole"></td>
          </tr>
          <tr>
            <td class="drug-name">Gentamicin inj.</td>
            <td>1.7-2.0 mg/kg q 12-24 hr</td>
            <td>1.7-2.0 mg/kg q 48 hr</td>
            <td>1.7-2.0 mg/kg q 48 hr (+extra 0.85-1.0 mg/kg AD)</td>
            <td class="dosing-column" data-drug="gentamicin"></td>
          </tr>
          <tr>
            <td class="drug-name">Levofloxacin 750 mg inj.</td>
            <td>CrCl 20-49: 750 mg IV q 48 hr</td>
            <td>CrCl <20: 750 mg x1, then 500 mg IV q 48 h</td>
            <td>750 mg initial dose then 500 mg IV q 48 hr</td>
            <td class="dosing-column" data-drug="levofloxacin"></td>
          </tr>
          <tr>
            <td class="drug-name">Penicillin G sodium 5 mu inj.</td>
            <td>0.5-4 mu IV q 8 hr</td>
            <td>0.5-4 mu IV q 12 hr</td>
            <td>0.5-4 mu IV q 12 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="penicillin-g"></td>
          </tr>
          <tr>
            <td class="drug-name">
              Tazocin¬Æ (Piperacillin Na. 4 g + Tazobactam Na. 0.5 g)
            </td>
            <td>
              CrCl 20-40: 3.375 gm IV q 6 hr<br />CrCl <20: 2.25 gm IV q 6 hr
            </td>
            <td>2.25 gm IV q 6 h</td>
            <td>2.25 gm IV q 6 h (+extra 0.75 gm AD)</td>
            <td class="dosing-column" data-drug="tazocin"></td>
          </tr>
          <tr>
            <td class="drug-name">Meropenem inj 1 g (DUE)</td>
            <td>0.5‚Äì1 gm IV q 12 hr</td>
            <td>0.5 gm q 24 hr</td>
            <td>0.5 gm q 24 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="meropenem"></td>
          </tr>
          <tr>
            <td class="drug-name">
              Tienem¬Æ inj. imipenem 500 mg + cilastatin 500 mg (DUE)
            </td>
            <td>0.5‚Äì1 gm IV q 12 hr</td>
            <td>125-250 mg q 12 hr</td>
            <td>125-250 mg q 12 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="tienem"></td>
          </tr>
          <tr>
            <td class="drug-name">Ertapenem inj.1 g (DUE)</td>
            <td>CrCL <30: 0.5 gm IV q 24 hr</td>
            <td>0.5 gm q 24 hr</td>
            <td>0.5 gm q 24 hr (+150 mg AD if give within 6 hr prior to HD)</td>
            <td class="dosing-column" data-drug="ertapenem"></td>
          </tr>
          <tr>
            <td class="drug-name">TMP/SMX inj. (TMP 80 mg/SMX 400 mg)</td>
            <td>
              CrCL 30-50: 5-20 mg/kg/day q 6-12 hr<br />CrCL 10-29: 5-10
              mg/kg/day q 12 hr
            </td>
            <td>Not recommend but if use TMP - 5-10 mg/kg OD</td>
            <td>Not recommend but if use TMP - 5-10 mg/kg OD give AD</td>
            <td class="dosing-column" data-drug="tmp-smx"></td>
          </tr>
          <tr>
            <td class="drug-name">Sitafloxacin 50 mg oral</td>
            <td>
              CrCL 30-49: 50 mg po q 24 hr<br />CrCL 10-30: 50 mg po q 48 hr
            </td>
            <td>50 mg po q 48 hr</td>
            <td>50 mg po q 48 hr</td>
            <td class="dosing-column" data-drug="sitafloxacin"></td>
          </tr>
          <tr>
            <td class="drug-name">Acyclovir oral (200 mg ‡πÅ‡∏•‡∏∞ 800 mg)</td>
            <td>CrCL 10-25: ‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏ï‡πá‡∏° ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</td>
            <td>‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏ï‡πá‡∏° ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 12 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</td>
            <td>‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏ï‡πá‡∏° ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 12 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="acyclovir-oral"></td>
          </tr>
          <tr>
            <td class="drug-name">Augmentin 1000 mg tab</td>
            <td>CrCL <30: 500/125 mg (amox) q 12-24 hr</td>
            <td>500/125 mg (amox) q 12-24 hr</td>
            <td>500/125 mg (amox) q 12-24 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="augmentin-tab"></td>
          </tr>
          <tr>
            <td class="drug-name">Cefixime 100 mg oral</td>
            <td>300 mg q 24 hr</td>
            <td>200 mg q 24 hr</td>
            <td>200 mg q 24 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="cefixime"></td>
          </tr>
          <tr>
            <td class="drug-name">Gabapentin (100 ‡πÅ‡∏•‡∏∞ 400 mg)</td>
            <td>CrCL <15: 100-300 ‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏Å‡∏£‡∏±‡∏° ‡πÉ‡∏´‡πâ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</td>
            <td>100-300 mg q 24 hr</td>
            <td>100-300 mg q 24 hr (dialysis day give AD)</td>
            <td class="dosing-column" data-drug="gabapentin"></td>
          </tr>
        </tbody>
      </table>

      <button class="export-btn" onclick="exportToExcel()">
        üì• Export to Excel (‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô Excel)
      </button>

      <div class="footer">
        <p>
          <strong>Reference:</strong> Adapted from standard antimicrobial dosing
          guidelines
        </p>
        <p><em>AD = after dialysis | ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≤‡∏° Cockcroft-Gault formula</em></p>
        <p><em>‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏¢‡∏≤</em></p>
      </div>
    </div>

    <script>
      let currentCrCL = 0;
      let isDialysis = false;
      let patientWeight = 0;
      let patientAge = 0;
      let patientGender = "";

      function calculateCrCL(age, weight, creatinine, gender) {
        // Cockcroft-Gault formula: CrCL = (140 - age) √ó weight / (72 √ó serum creatinine)
        // For females, multiply by 0.85
        let crcl = ((140 - age) * weight) / (72 * creatinine);
        if (gender === "female") {
          crcl *= 0.85;
        }
        return Math.round(crcl * 100) / 100; // Round to 2 decimal places
      }

      function calculateDosing() {
        const age = parseInt(document.getElementById("age").value);
        const weight = parseFloat(document.getElementById("weight").value);
        const creatinine = parseFloat(
          document.getElementById("creatinine").value
        );
        const gender = document.getElementById("gender").value;
        const dialysis = document.getElementById("dialysis").value;
        const indication =
          document.getElementById("indication").value || "General infection";

        if (!age || !weight || !creatinine || !gender) {
          alert(
            "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô / Please fill in all required fields"
          );
          return;
        }

        // Validation
        if (age < 1 || age > 120) {
          alert(
            "‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 1-120 ‡∏õ‡∏µ / Age must be between 1-120 years"
          );
          return;
        }

        if (weight < 1 || weight > 300) {
          alert(
            "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 1-300 ‡∏Å‡∏¥‡πÇ‡∏•‡∏Å‡∏£‡∏±‡∏° / Weight must be between 1-300 kg"
          );
          return;
        }

        if (creatinine < 0.1 || creatinine > 20) {
          alert(
            "‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏£‡∏µ‡πÄ‡∏≠‡∏ï‡∏¥‡∏ô‡∏µ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 0.1-20 mg/dL / Creatinine must be between 0.1-20 mg/dL"
          );
          return;
        }

        // Store global variables
        patientWeight = weight;
        patientAge = age;
        patientGender = gender;
        isDialysis = dialysis === "yes";

        if (isDialysis) {
          currentCrCL = 0; // For dialysis patients, CrCL is irrelevant
        } else {
          currentCrCL = calculateCrCL(age, weight, creatinine, gender);
        }

        // Display results
        const resultDiv = document.getElementById("crclResult");
        let resultHTML = `<h3>üìã ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì / Calculation Results</h3>`;

        resultHTML += `<div class="result-info">`;
        resultHTML += `<p><strong>‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢:</strong> ${
          gender === "male" ? "‡∏ä‡∏≤‡∏¢" : "‡∏´‡∏ç‡∏¥‡∏á"
        }, ‡∏≠‡∏≤‡∏¢‡∏∏ ${age} ‡∏õ‡∏µ</p>`;
        resultHTML += `<p><strong>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å:</strong> ${weight} kg</p>`;
        resultHTML += `<p><strong>Serum Creatinine:</strong> ${creatinine} mg/dL</p>`;
        resultHTML += `<p><strong>‡∏Ç‡πâ‡∏≠‡∏ö‡πà‡∏á‡πÉ‡∏ä‡πâ:</strong> ${indication}</p>`;

        if (isDialysis) {
          resultHTML += `<p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> üè• ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï</p>`;
          resultHTML += `<p><strong>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏¢‡∏≤:</strong> ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå Hemodialysis</p>`;
        } else {
          resultHTML += `<p><strong>CrCL (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì):</strong> ${currentCrCL} mL/min</p>`;
          if (currentCrCL >= 10 && currentCrCL <= 50) {
            resultHTML += `<p><strong>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</strong> üü° CrCL 10-50 mL/min (‡πÑ‡∏ï‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á)</p>`;
          } else if (currentCrCL < 10) {
            resultHTML += `<p><strong>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</strong> üî¥ CrCL < 10 mL/min (‡πÑ‡∏ï‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á)</p>`;
          } else {
            resultHTML += `<p><strong>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</strong> üü¢ ‡πÑ‡∏ï‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ (CrCL > 50)</p>`;
            resultHTML += `<p><em>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏ï‡∏•‡∏î‡∏•‡∏á</em></p>`;
          }
        }
        resultHTML += `</div>`;

        // Add warning for elderly patients
        if (age >= 65) {
          resultHTML += `<div class="warning-box">‚ö†Ô∏è ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏: ‡∏Ñ‡∏ß‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î</div>`;
        }

        resultDiv.innerHTML = resultHTML;
        resultDiv.style.display = "block";

        // Update dosing recommendations in table
        updateDosingRecommendations();
      }

      function calculateSpecificDose(doseString, weight) {
        // Helper function to calculate mg/kg doses
        if (doseString.includes("mg/kg")) {
          const matches = doseString.match(
            /(\d+(?:\.\d+)?(?:-\d+(?:\.\d+)?)?)\s*mg\/kg/g
          );
          if (matches) {
            let calculations = [];
            matches.forEach((match) => {
              const doseMatch = match.match(
                /(\d+(?:\.\d+)?(?:-\d+(?:\.\d+)?)?)/
              );
              if (doseMatch) {
                const doseRange = doseMatch[1];
                if (doseRange.includes("-")) {
                  const [min, max] = doseRange.split("-").map(Number);
                  const minDose = Math.round(min * weight * 10) / 10;
                  const maxDose = Math.round(max * weight * 10) / 10;
                  calculations.push(`${minDose}-${maxDose} mg`);
                } else {
                  const dose = Math.round(Number(doseRange) * weight * 10) / 10;
                  calculations.push(`${dose} mg`);
                }
              }
            });
            return calculations.length > 0 ? calculations.join(" ‡∏´‡∏£‡∏∑‡∏≠ ") : null;
          }
        }
        return null;
      }

      function updateDosingRecommendations() {
        const dosingColumns = document.querySelectorAll(".dosing-column");

        dosingColumns.forEach((column) => {
          const row = column.parentElement;
          const cells = row.cells;

          // Check if we have enough cells to read from
          if (cells.length < 4) return;

          const drugName = cells[0].textContent;
          let recommendedDose = "";
          let calculatedDose = "";
          let sourceColumn = "";

          // Determine which column to use based on patient status
          if (isDialysis) {
            recommendedDose =
              cells[3] && cells[3].textContent.trim()
                ? cells[3].textContent
                : "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï";
            sourceColumn = "Hemodialysis";
          } else if (currentCrCL >= 10 && currentCrCL <= 50) {
            recommendedDose =
              cells[1] && cells[1].textContent.trim()
                ? cells[1].textContent
                : "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á CrCL ‡∏ô‡∏µ‡πâ";
            sourceColumn = "CrCL 10-50";
          } else if (currentCrCL < 10) {
            recommendedDose =
              cells[2] && cells[2].textContent.trim()
                ? cells[2].textContent
                : "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÑ‡∏ï‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á";
            sourceColumn = "CrCL < 10";
          } else {
            recommendedDose = "‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô";
            sourceColumn = "Normal kidney function";
          }

          // Handle special cases for empty cells
          if (!recommendedDose || recommendedDose.trim() === "") {
            if (drugName.includes("Gabapentin")) {
              if (currentCrCL >= 15) {
                recommendedDose = "‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (CrCL ‚â•15)";
              } else {
                recommendedDose = "100-300 mg q 24 hr";
              }
            } else if (drugName.includes("Ampicillin inj. 1000 mg")) {
              recommendedDose = "‡πÉ‡∏ä‡πâ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Ampicillin 500 mg";
            } else {
              recommendedDose = "‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏¢‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏†‡∏™‡∏±‡∏ä‡∏Å‡∏£";
            }
          }

          // Calculate specific doses for mg/kg drugs
          if (patientWeight > 0 && recommendedDose.includes("mg/kg")) {
            calculatedDose = calculateSpecificDose(
              recommendedDose,
              patientWeight
            );
          }

          // Create comprehensive result display
          let resultHTML = `<div class="calculated-dose">`;
          resultHTML += `<strong>‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á (${sourceColumn}):</strong><br>`;
          resultHTML += `${recommendedDose}`;

          if (calculatedDose) {
            resultHTML += `<br><br><strong>‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ${patientWeight} kg:</strong><br>`;
            resultHTML += `<span style="color: #0c5460; font-size: 16px;">${calculatedDose}</span>`;
          }

          // Add timing information based on the recommended dose
          if (recommendedDose.includes("q 6")) {
            resultHTML += `<br><small>üìÖ ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 6 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (4 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ß‡∏±‡∏ô)</small>`;
          } else if (recommendedDose.includes("q 8")) {
            resultHTML += `<br><small>üìÖ ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ß‡∏±‡∏ô)</small>`;
          } else if (recommendedDose.includes("q 12")) {
            resultHTML += `<br><small>üìÖ ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 12 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ß‡∏±‡∏ô)</small>`;
          } else if (recommendedDose.includes("q 24")) {
            resultHTML += `<br><small>üìÖ ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ß‡∏±‡∏ô)</small>`;
          } else if (recommendedDose.includes("q 48")) {
            resultHTML += `<br><small>üìÖ ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å 48 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á (‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏±‡∏ô)</small>`;
          }

          // Add special warnings
          if (recommendedDose.includes("AD") && isDialysis) {
            resultHTML += `<br><div class="warning-box">üíâ ‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏•‡∏±‡∏á‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï (After Dialysis)</div>`;
          }

          if (recommendedDose.includes("Not recommend")) {
            resultHTML += `<br><div class="warning-box">‚ö†Ô∏è ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏¢‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏Å‡∏•‡∏∏‡∏°‡∏ô‡∏µ‡πâ</div>`;
          }

          resultHTML += `</div>`;

          column.innerHTML = resultHTML;
        });
      }

      function clearForm() {
        document.getElementById("age").value = "";
        document.getElementById("weight").value = "";
        document.getElementById("creatinine").value = "";
        document.getElementById("gender").value = "";
        document.getElementById("dialysis").value = "no";
        document.getElementById("indication").value = "";

        document.getElementById("crclResult").style.display = "none";

        // Clear all dosing recommendations
        const dosingColumns = document.querySelectorAll(".dosing-column");
        dosingColumns.forEach((column) => {
          column.innerHTML =
            '<div style="text-align: center; color: #6c757d; font-style: italic;">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤</div>';
        });

        // Reset global variables
        currentCrCL = 0;
        isDialysis = false;
        patientWeight = 0;
        patientAge = 0;
        patientGender = "";
      }

      function exportToExcel() {
        // Get the table
        const table = document.getElementById("dosingTable");

        // Clone the table to avoid modifying the original
        const tableClone = table.cloneNode(true);

        // Add patient information as header rows if calculation has been done
        if (patientWeight > 0) {
          const headerRow1 = tableClone.insertRow(0);
          headerRow1.insertCell(0).innerHTML = `Patient Information: ${
            patientGender === "male" ? "Male" : "Female"
          }, Age ${patientAge} years, Weight ${patientWeight} kg`;
          headerRow1.cells[0].colSpan = 5;

          const headerRow2 = tableClone.insertRow(1);
          if (isDialysis) {
            headerRow2.insertCell(0).innerHTML = `Status: Hemodialysis Patient`;
          } else {
            headerRow2.insertCell(
              0
            ).innerHTML = `Calculated CrCL: ${currentCrCL} mL/min`;
          }
          headerRow2.cells[0].colSpan = 5;

          const spacerRow = tableClone.insertRow(2);
          spacerRow.insertCell(0).innerHTML = "";
          spacerRow.cells[0].colSpan = 5;
        }

        // Create a workbook
        const wb = XLSX.utils.book_new();

        // Convert table to worksheet
        const ws = XLSX.utils.table_to_sheet(tableClone);

        // Set column widths
        ws["!cols"] = [
          { wch: 25 }, // Drug name
          { wch: 25 }, // CrCL 10-50
          { wch: 25 }, // CrCL < 10
          { wch: 25 }, // Hemodialysis
          { wch: 30 }, // Calculated dose
        ];

        // Add the worksheet to the workbook
        XLSX.utils.book_append_sheet(wb, ws, "Medical Dosing Guidelines");

        // Generate filename with timestamp
        const now = new Date();
        const timestamp = now.toISOString().slice(0, 10);
        const filename = `Medical_Dosing_Guidelines_${timestamp}.xlsx`;

        // Save the file
        XLSX.writeFile(wb, filename);
      }

      // Initialize the form
      document.addEventListener("DOMContentLoaded", function () {
        clearForm();

        // Add form validation
        const form = document.getElementById("dosingForm");
        const inputs = form.querySelectorAll(
          "input[required], select[required]"
        );

        inputs.forEach((input) => {
          input.addEventListener("blur", function () {
            if (!this.value) {
              this.style.borderColor = "#dc3545";
            } else {
              this.style.borderColor = "#28a745";
            }
          });

          input.addEventListener("input", function () {
            if (this.value) {
              this.style.borderColor = "#ced4da";
            }
          });
        });
      });

      // Add keyboard shortcuts
      document.addEventListener("keydown", function (e) {
        if (e.ctrlKey && e.key === "Enter") {
          calculateDosing();
        }
        if (e.ctrlKey && e.key === "Delete") {
          clearForm();
        }
      });
    </script>
  </body>
</html>
